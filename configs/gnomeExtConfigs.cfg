# https://itsfoss.com/gnome-shell-extensions/
# https://linuxconfig.org/how-to-install-gnome-shell-extensions-from-zip-file-using-command-line-on-ubuntu-18-04-bionic-beaver-linux

localGnomeExtLocation=~/.local/share/gnome-shell/extensions/

# Gets info about the file
function getFileInfo()
{

    fullFilename=$(basename $url)

    fileName=$( echo $fullFilename | cut -d. -f1)
    extension=$( echo $fullFilename | cut -d. -f2)
}

## By the end of this the file is only downloaded
function getExtension()
{
    getFileInfo

    #change pwd
    cd ~/Downloads

    if [ "$extension" == "git" ]; then

        # the fileName var is the same as the name of the output Dir for the record
        if [ ! -d "$fileName" ]; then
            git clone $url
        else
            echo -e "Directory already exists"
        fi


            # cd into directory
            cd $fileName

            uuid=$(find . -type f -name "metadata.json" -exec cat {} + | grep -m1 -i uuid | cut -d: -f2 | sed 's/ //g;s/"//g;s/,//g')

            extensionName=$(find . -type f -name "metadata.json" -exec cat {} + | grep -m1 -i name | cut -d: -f2 | sed 's/ //g;s/"//g;s/,//g')

            extractionLocation=$localGnomeExtLocation$uuid

            clear
            echo -e "Manually Installing $extensionName"

            if [ ! -d $extractionLocation ]; then

                # makes directory in proper location
                echo -e "Creating needed directory: $extractionLocation"
                mkdir -p $extractionLocation


                echo -e "Copying Extension to Home folder location"
                cp -r $extractionName $localGnomeExtLocation
                userPrompt


            else
                echo -e "$extractionLocation already exists"
                userPrompt

            fi

            echo -e "You can type Alt+F2 then type R (and press enter) and the extension should be there now"
            userPrompt


    elif [ "$extension" == "zip" ]; then
        wget $url
    fi

}


##########################################################################

function soundInputOutputChooser()
{
    url="https://github.com/kgshank/gse-sound-output-device-chooser.git"

    getExtension $url
}


function nightLightSlider()
{
    url="https://github.com/kiyui/gnome-shell-night-light-slider-extension.git"

    getExtension $url
}

function impatience()
{
    url="https://github.com/timbertson/gnome-shell-impatience.git"

    getExtension $url
}

function transparentWindowMoving()
{
    cd ~/Downloads
    git clone https://github.com/Noobsai/transparent-window-moving.git
    cd transparent-window-moving
    make install

    userPrompt
}